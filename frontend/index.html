<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Research Assistant — Multi-Agent AI</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'><circle cx='16' cy='16' r='14' fill='%234f46e5'/><text x='16' y='22' font-size='18' text-anchor='middle' fill='white'>R</text></svg>">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- ──────────── TOP NAV ──────────── -->
    <nav class="topnav">
        <div class="nav-brand">
            <div class="brand-icon">R</div>
            <span class="brand-text">Research Assistant</span>
            <span class="brand-badge">AI</span>
        </div>
        <div class="nav-links">
            <button class="nav-btn active" data-view="research">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>
                Research
            </button>
            <button class="nav-btn" data-view="history">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
                History
            </button>
        </div>
        <div class="nav-status">
            <span class="status-dot" id="apiStatusDot"></span>
            <span class="status-text" id="apiStatusText">Connecting…</span>
        </div>
    </nav>

    <!-- ──────────── MAIN CONTENT ──────────── -->
    <main class="main-content">

        <!-- ═══════ RESEARCH VIEW ═══════ -->
        <section id="viewResearch" class="view active">

            <!-- Hero / Input Area -->
            <div class="hero-section">
                <h1 class="hero-title">Multi-Agent Research Assistant</h1>
                <p class="hero-subtitle">5 specialized AI agents collaborate to research, analyze, verify, and generate comprehensive reports on any topic.</p>

                <form id="researchForm" class="research-form" autocomplete="off">
                    <div class="input-group">
                        <textarea id="queryInput" rows="2" placeholder="Enter your research question… (min 5 characters)" required minlength="5" maxlength="500"></textarea>
                        <button type="submit" class="btn-primary" id="btnStart">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="5 3 19 12 5 21 5 3"/></svg>
                            Start Research
                        </button>
                    </div>

                    <!-- Advanced Options -->
                    <details class="advanced-options">
                        <summary>Advanced Options</summary>
                        <div class="options-grid">
                            <div class="option">
                                <label for="focusAreas">Focus Areas</label>
                                <input type="text" id="focusAreas" placeholder="e.g. regulatory, technical, ethical" />
                                <span class="hint">Comma-separated, any topic accepted</span>
                            </div>
                            <div class="option">
                                <label for="sourcePrefs">Source Preferences</label>
                                <select id="sourcePrefs" multiple>
                                    <option value="academic">Academic</option>
                                    <option value="news">News</option>
                                    <option value="official">Official</option>
                                    <option value="wikipedia">Wikipedia</option>
                                </select>
                            </div>
                            <div class="option">
                                <label for="reportFormat">Report Format</label>
                                <select id="reportFormat">
                                    <option value="markdown">Markdown</option>
                                    <option value="html">HTML</option>
                                    <option value="pdf">PDF</option>
                                </select>
                            </div>
                            <div class="option">
                                <label for="citationStyle">Citation Style</label>
                                <select id="citationStyle">
                                    <option value="APA">APA</option>
                                    <option value="MLA">MLA</option>
                                    <option value="Chicago">Chicago</option>
                                </select>
                            </div>
                            <div class="option">
                                <label for="maxSources">Max Sources</label>
                                <input type="number" id="maxSources" value="300" min="10" max="1000" />
                            </div>
                            <div class="option">
                                <label for="researchMode">Mode</label>
                                <select id="researchMode">
                                    <option value="auto">Automatic</option>
                                    <option value="supervised">Supervised</option>
                                </select>
                            </div>
                        </div>
                    </details>
                </form>
            </div>

            <!-- Agent Pipeline Visualization -->
            <div id="pipelineSection" class="pipeline-section hidden">
                <h2 class="section-title">Agent Pipeline</h2>
                <div class="pipeline">
                    <div class="pipeline-agent" id="agent-user_proxy">
                        <div class="agent-icon">
                            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
                        </div>
                        <div class="agent-info">
                            <span class="agent-name">User Proxy</span>
                            <span class="agent-role">Query analysis</span>
                            <div class="agent-bar"><div class="agent-bar-fill" style="width:0%"></div></div>
                            <span class="agent-status-text">Waiting</span>
                        </div>
                    </div>
                    <div class="pipeline-arrow">→</div>

                    <div class="pipeline-agent" id="agent-researcher">
                        <div class="agent-icon">
                            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>
                        </div>
                        <div class="agent-info">
                            <span class="agent-name">Researcher</span>
                            <span class="agent-role">Data collection</span>
                            <div class="agent-bar"><div class="agent-bar-fill" style="width:0%"></div></div>
                            <span class="agent-status-text">Waiting</span>
                        </div>
                    </div>
                    <div class="pipeline-arrow">→</div>

                    <div class="pipeline-agent" id="agent-analyst">
                        <div class="agent-icon">
                            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/></svg>
                        </div>
                        <div class="agent-info">
                            <span class="agent-name">Analyst</span>
                            <span class="agent-role">Synthesis &amp; patterns</span>
                            <div class="agent-bar"><div class="agent-bar-fill" style="width:0%"></div></div>
                            <span class="agent-status-text">Waiting</span>
                        </div>
                    </div>
                    <div class="pipeline-arrow">→</div>

                    <div class="pipeline-agent" id="agent-fact_checker">
                        <div class="agent-icon">
                            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
                        </div>
                        <div class="agent-info">
                            <span class="agent-name">Fact Checker</span>
                            <span class="agent-role">Verification</span>
                            <div class="agent-bar"><div class="agent-bar-fill" style="width:0%"></div></div>
                            <span class="agent-status-text">Waiting</span>
                        </div>
                    </div>
                    <div class="pipeline-arrow">→</div>

                    <div class="pipeline-agent" id="agent-report_generator">
                        <div class="agent-icon">
                            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/></svg>
                        </div>
                        <div class="agent-info">
                            <span class="agent-name">Report Generator</span>
                            <span class="agent-role">Report creation</span>
                            <div class="agent-bar"><div class="agent-bar-fill" style="width:0%"></div></div>
                            <span class="agent-status-text">Waiting</span>
                        </div>
                    </div>
                </div>

                <!-- Overall Progress -->
                <div class="overall-progress">
                    <div class="overall-bar"><div class="overall-bar-fill" id="overallBarFill" style="width:0%"></div></div>
                    <div class="overall-info">
                        <span id="overallPercent">0%</span>
                        <span id="overallPhase">Initializing…</span>
                        <button class="btn-cancel hidden" id="btnCancel">Cancel</button>
                    </div>
                </div>

                <!-- Live Log -->
                <div class="live-log" id="liveLog">
                    <div class="log-header">
                        <span>Live Activity</span>
                        <button class="log-clear" id="btnClearLog">Clear</button>
                    </div>
                    <div class="log-entries" id="logEntries"></div>
                </div>
            </div>

            <!-- Results Section -->
            <div id="resultsSection" class="results-section hidden">
                <div class="results-header">
                    <h2 class="section-title" id="resultsTitle">Research Results</h2>
                    <div class="results-actions">
                        <button class="btn-outline" id="btnDownloadMd">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
                            Markdown
                        </button>
                        <button class="btn-outline" id="btnDownloadHtml">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
                            HTML
                        </button>
                        <button class="btn-outline" id="btnNewResearch">New Research</button>
                    </div>
                </div>

                <!-- Tabs -->
                <div class="tab-bar">
                    <button class="tab active" data-tab="report">Report</button>
                    <button class="tab" data-tab="findings">Findings</button>
                    <button class="tab" data-tab="sources">Sources</button>
                    <button class="tab" data-tab="metadata">Metadata</button>
                </div>

                <div class="tab-content" id="tabReport">
                    <div class="report-content" id="reportContent"></div>
                </div>
                <div class="tab-content hidden" id="tabFindings">
                    <div class="findings-list" id="findingsList"></div>
                </div>
                <div class="tab-content hidden" id="tabSources">
                    <div class="sources-list" id="sourcesList"></div>
                </div>
                <div class="tab-content hidden" id="tabMetadata">
                    <div class="metadata-content" id="metadataContent"></div>
                </div>
            </div>
        </section>

        <!-- ═══════ HISTORY VIEW ═══════ -->
        <section id="viewHistory" class="view">
            <div class="history-header">
                <h2 class="section-title">Research History</h2>
                <div class="history-controls">
                    <input type="text" id="historySearch" placeholder="Search past research…" />
                    <select id="historyFilter">
                        <option value="">All Statuses</option>
                        <option value="completed">Completed</option>
                        <option value="running">Running</option>
                        <option value="failed">Failed</option>
                        <option value="cancelled">Cancelled</option>
                    </select>
                </div>
            </div>
            <div class="history-list" id="historyList">
                <p class="empty-state">Loading history…</p>
            </div>
        </section>
    </main>

    <!-- ──────────── TOAST NOTIFICATIONS ──────────── -->
    <div class="toast-container" id="toastContainer"></div>

    <script src="app.js"></script>
</body>
</html>
